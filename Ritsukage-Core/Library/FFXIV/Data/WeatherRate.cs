using System;
using System.Collections.Generic;
using System.Linq;

namespace Ritsukage.Library.FFXIV.Data
{
    public static class WeatherRate
    {
        public struct WeatherRateList
        {
            readonly SortedList<int, int> List;

            public WeatherRateList(SortedList<int, int> data)
            {
                List = data;
            }

            public int GetWeather(int rate)
                => rate < 100 ? (List == null ? 0 : List.FirstOrDefault(x => rate < x.Key).Value) : 0;

            public bool ContainsValue(int weatherID)
                => List != null && List.Any(x => x.Value == weatherID);

            public IEnumerable<int> GetWeathers() => List?.Select(x => x.Value);

            public IEnumerable<string> GetWeatherNames() => List?.Select(x => Weather.GetWeatherName(x.Value));

            public override string ToString()
                => List == null ? string.Empty : string.Join("\n", List.Select(x => $"(Rate: {x.Key}, Weather:{x.Value})"));
        }

        static readonly Dictionary<int, WeatherRateList> Data = new()
        {
            { 0, new(new() { { 100, 2 } }) },
            { 1, new(new() { { 5, 7 }, { 20, 7 }, { 30, 4 }, { 40, 3 }, { 55, 2 }, { 85, 1 }, { 100, 2 } }) },
            { 2, new(new() { { 5, 7 }, { 20, 7 }, { 30, 4 }, { 40, 3 }, { 55, 2 }, { 85, 1 }, { 100, 2 } }) },
            { 3, new(new() { { 5, 9 }, { 20, 7 }, { 30, 4 }, { 40, 3 }, { 55, 2 }, { 85, 1 }, { 100, 2 } }) },
            { 4, new(new() { { 5, 9 }, { 20, 7 }, { 30, 4 }, { 40, 3 }, { 55, 2 }, { 85, 1 }, { 100, 2 } }) },
            { 5, new(new() { { 5, 4 }, { 10, 10 }, { 25, 9 }, { 30, 4 }, { 40, 3 }, { 70, 2 }, { 100, 1 } }) },
            { 6, new(new() { { 5, 4 }, { 10, 8 }, { 25, 7 }, { 30, 4 }, { 40, 3 }, { 70, 2 }, { 100, 1 } }) },
            { 7, new(new() { { 40, 1 }, { 60, 2 }, { 85, 3 }, { 95, 4 }, { 100, 7 } }) },
            { 8, new(new() { { 40, 1 }, { 60, 2 }, { 85, 3 }, { 95, 4 }, { 100, 7 } }) },
            { 9, new(new() { { 40, 1 }, { 60, 2 }, { 85, 3 }, { 95, 4 }, { 100, 7 } }) },
            { 10, new(new() { { 15, 11 }, { 55, 1 }, { 75, 2 }, { 85, 3 }, { 95, 4 }, { 100, 7 } }) },
            { 11, new(new() { { 40, 1 }, { 60, 2 }, { 70, 3 }, { 80, 4 }, { 85, 7 }, { 100, 8 } }) },
            { 12, new(new() { { 20, 14 }, { 60, 1 }, { 80, 2 }, { 90, 3 }, { 100, 4 } }) },
            { 13, new(new() { { 5, 1 }, { 20, 2 }, { 50, 3 }, { 100, 4 } }) },
            { 14, new(new() { { 20, 3 }, { 50, 1 }, { 80, 2 }, { 90, 4 }, { 100, 7 } }) },
            { 15, new(new() { { 20, 3 }, { 50, 1 }, { 80, 2 }, { 90, 4 }, { 100, 7 } }) },
            { 16, new(new() { { 20, 3 }, { 50, 1 }, { 70, 2 }, { 80, 5 }, { 90, 4 }, { 100, 7 } }) },
            { 17, new(new() { { 20, 3 }, { 50, 1 }, { 70, 2 }, { 80, 5 }, { 90, 4 }, { 100, 7 } }) },
            { 18, new(new() { { 5, 4 }, { 50, 1 }, { 80, 2 }, { 90, 3 }, { 95, 7 }, { 100, 8 } }) },
            { 19, new(new() { { 10, 4 }, { 40, 1 }, { 60, 2 }, { 80, 3 }, { 90, 5 }, { 100, 6 } }) },
            { 20, new(new() { { 30, 1 }, { 50, 2 }, { 70, 3 }, { 80, 4 }, { 90, 9 }, { 100, 10 } }) },
            { 21, new(new() { { 20, 16 }, { 60, 15 }, { 70, 2 }, { 75, 1 }, { 90, 3 }, { 100, 4 } }) },
            { 22, new(new() { { 15, 3 }, { 30, 4 }, { 60, 17 }, { 75, 1 }, { 100, 2 } }) },
            { 23, new(new() { { 100, 29 } }) },
            { 24, new(new() { { 30, 1 }, { 50, 2 }, { 70, 3 }, { 85, 4 }, { 100, 7 } }) },
            { 25, new(new() { { 100, 26 } }) },
            { 26, new(new() { { 100, 28 } }) },
            { 27, new(new() { { 100, 15 } }) },
            { 28, new(new() { { 100, 3 } }) },
            { 29, new(new() { { 20, 3 }, { 50, 1 }, { 80, 2 }, { 90, 4 }, { 100, 10 } }) },
            { 30, new(new() { { 100, 27 } }) },
            { 31, new(new() { { 100, 25 } }) },
            { 32, new(new() { { 20, 3 }, { 50, 1 }, { 70, 2 }, { 80, 2 }, { 90, 4 }, { 100, 7 } }) },
            { 33, new(new() { { 40, 1 }, { 60, 2 }, { 85, 3 }, { 95, 4 }, { 100, 7 } }) },
            { 34, new(new() { { 5, 3 }, { 20, 7 }, { 30, 4 }, { 40, 3 }, { 55, 2 }, { 85, 1 }, { 100, 2 } }) },
            { 35, new(new() { { 100, 15 } }) },
            { 36, new(new() { { 100, 5 } }) },
            { 37, new(new() { { 100, 9 } }) },
            { 38, new(new() { { 100, 23 } }) },
            { 39, new(new() { { 100, 24 } }) },
            { 40, new(new() { { 100, 4 } }) },
            { 41, new(new() { { 100, 11 } }) },
            { 42, new(new() { { 100, 16 } }) },
            { 43, new(new() { { 100, 22 } }) },
            { 44, new(new() { { 100, 36 } }) },
            { 45, new(new() { { 100, 20 } }) },
            { 46, new(new() { { 100, 35 } }) },
            { 47, new(new() { { 60, 15 }, { 70, 2 }, { 75, 1 }, { 90, 3 }, { 100, 4 } }) },
            { 48, new(new() { { 60, 15 }, { 70, 2 }, { 75, 1 }, { 90, 3 }, { 100, 4 } }) },
            { 49, new(new() { { 20, 16 }, { 60, 15 }, { 70, 2 }, { 75, 1 }, { 90, 3 }, { 100, 4 } }) },
            { 50, new(new() { { 10, 3 }, { 20, 4 }, { 30, 9 }, { 40, 11 }, { 70, 1 }, { 100, 2 } }) },
            { 51, new(new() { { 10, 3 }, { 20, 4 }, { 30, 7 }, { 40, 8 }, { 70, 1 }, { 100, 2 } }) },
            { 52, new(new() { { 10, 3 }, { 20, 6 }, { 40, 50 }, { 70, 1 }, { 100, 2 } }) },
            { 53, new(new() { { 30, 1 }, { 60, 2 }, { 70, 3 }, { 80, 4 }, { 90, 5 }, { 100, 49 } }) },
            { 54, new(new() { { 35, 2 }, { 70, 3 }, { 100, 9 } }) },
            { 55, new(new() { { 10, 3 }, { 20, 4 }, { 30, 7 }, { 40, 8 }, { 70, 1 }, { 100, 2 } }) },
            { 56, new(new() { { 100, 44 } }) },
            { 57, new(new() { { 100, 51 } }) },
            { 58, new(new() { { 100, 1 } }) },
            { 59, new(new() { { 15, 4 }, { 40, 7 }, { 100, 2 } }) },
            { 60, new(new() { { 40, 2 }, { 75, 4 }, { 95, 5 }, { 99, 49 }, { 100, 54 } }) },
            { 61, new(new() { { 40, 2 }, { 60, 4 }, { 95, 5 }, { 99, 49 }, { 100, 54 } }) },
            { 62, new(new() { { 40, 2 }, { 65, 4 }, { 90, 5 }, { 98, 49 }, { 100, 54 } }) },
            { 63, new(new() { { 100, 7 } }) },
            { 64, new(new() { { 60, 2 }, { 100, 7 } }) },
            { 65, new(new() { { 50, 2 }, { 100, 7 } }) },
            { 66, new(new() { { 100, 60 } }) },
            { 67, new(new() { { 35, 2 }, { 65, 15 }, { 85, 16 }, { 100, 4 } }) },
            { 68, new(new() { { 100, 14 } }) },
            { 69, new(new() { { 100, 69 } }) },
            { 70, new(new() { { 100, 54 } }) },
            { 71, new(new() { { 30, 2 }, { 60, 4 }, { 90, 5 }, { 100, 49 } }) },
            { 72, new(new() { { 65, 2 }, { 100, 7 } }) },
            { 73, new(new() { { 65, 2 }, { 100, 7 } }) },
            { 74, new(new() { { 100, 17 } }) },
            { 75, new(new() { { 100, 74 } }) },
            { 76, new(new() { { 100, 84 } }) },
            { 77, new(new() { { 100, 80 } }) },
            { 78, new(new() { { 15, 1 }, { 60, 2 }, { 80, 3 }, { 90, 4 }, { 100, 9 } }) },
            { 79, new(new() { { 15, 1 }, { 60, 2 }, { 80, 3 }, { 90, 4 }, { 100, 9 } }) },
            { 80, new(new() { { 10, 1 }, { 60, 2 }, { 75, 3 }, { 85, 4 }, { 95, 5 }, { 100, 11 } }) },
            { 81, new(new() { { 20, 1 }, { 60, 2 }, { 80, 3 }, { 90, 4 }, { 100, 10 } }) },
            { 82, new(new() { { 10, 7 }, { 20, 4 }, { 40, 3 }, { 80, 2 }, { 100, 1 } }) },
            { 83, new(new() { { 10, 9 }, { 20, 5 }, { 35, 3 }, { 75, 2 }, { 100, 1 } }) },
            { 84, new(new() { { 5, 8 }, { 15, 7 }, { 25, 4 }, { 40, 3 }, { 80, 2 }, { 100, 1 } }) },
            { 85, new(new() { { 5, 6 }, { 10, 5 }, { 17, 7 }, { 25, 4 }, { 35, 3 }, { 75, 2 }, { 100, 1 } }) },
            { 86, new(new() { { 100, 50 } }) },
            { 87, new(new() { { 100, 82 } }) },
            { 88, new(new() { { 100, 79 } }) },
            { 89, new(new() { { 100, 88 } }) },
            { 90, new(new() { { 100, 2 } }) },
            { 91, new(new() { { 30, 2 }, { 60, 6 }, { 90, 8 }, { 100, 15 } }) },
            { 92, new(new() { { 100, 77 } }) },
            { 93, new(new() { { 100, 92 } }) },
            { 94, new(new() { { 10, 2 }, { 28, 4 }, { 46, 14 }, { 64, 15 }, { 82, 9 }, { 100, 16 } }) },
            { 95, new(new() { { 100, 101 } }) },
            { 96, new(new() { { 10, 2 }, { 28, 14 }, { 46, 9 }, { 64, 16 }, { 82, 49 }, { 100, 15 } }) },
            { 97, new(new() { { 100, 12 } }) },
            { 98, new(new() { { 100, 102 } }) },
            { 99, new(new() { { 100, 113 } }) },
            { 100, new(new() { { 12, 2 }, { 34, 8 }, { 56, 17 }, { 78, 10 }, { 100, 15 } }) },
            { 101, new(new() { { 100, 119 } }) },
            { 102, new(new() { { 100, 118 } }) },
            { 103, new(new() { { 100, 122 } }) },
            { 104, new(new() { { 100, 125 } }) },
            { 105, new(new() { { 100, 120 } }) },
            { 106, new(new() { { 20, 1 }, { 60, 2 }, { 75, 3 }, { 85, 4 }, { 95, 7 }, { 100, 10 } }) },
            { 107, new(new() { { 10, 6 }, { 20, 7 }, { 30, 4 }, { 45, 3 }, { 85, 2 }, { 100, 1 } }) },
            { 108, new(new() { { 45, 2 }, { 60, 3 }, { 70, 11 }, { 80, 14 }, { 100, 1 } }) },
            { 109, new(new() { { 10, 7 }, { 20, 4 }, { 35, 3 }, { 45, 10 }, { 60, 1 }, { 100, 2 } }) },
            { 110, new(new() { { 10, 4 }, { 20, 7 }, { 30, 49 }, { 45, 1 }, { 85, 2 }, { 100, 3 } }) },
            { 111, new(new() { { 20, 3 }, { 80, 2 }, { 100, 1 } }) },
            { 112, new(new() { { 20, 1 }, { 60, 2 }, { 75, 3 }, { 85, 4 }, { 95, 7 }, { 100, 10 } }) },
            { 113, new(new() { { 10, 6 }, { 20, 7 }, { 30, 4 }, { 45, 3 }, { 85, 2 }, { 100, 1 } }) },
            { 114, new(new() { { 100, 105 } }) },
            { 115, new(new() { { 100, 10 } }) },
            { 116, new(new() { { 100, 127 } }) },
            { 117, new(new() { { 50, 2 }, { 80, 5 }, { 90, 7 }, { 95, 6 }, { 100, 4 } }) },
            { 118, new(new() { { 50, 1 }, { 100, 2 } }) },
            { 119, new(new() { { 45, 2 }, { 63, 3 }, { 80, 4 }, { 95, 7 }, { 100, 8 } }) },
            { 120, new(new() { { 40, 2 }, { 55, 3 }, { 70, 4 }, { 95, 5 }, { 100, 6 } }) },
            { 121, new(new() { { 35, 2 }, { 50, 3 }, { 65, 4 }, { 85, 15 }, { 100, 16 } }) },
            { 122, new(new() { { 82, 2 }, { 87, 3 }, { 92, 4 }, { 97, 11 }, { 100, 14 } }) },
            { 123, new(new() { { 100, 138 } }) },
            { 124, new(new() { { 52, 2 }, { 64, 7 }, { 76, 5 }, { 88, 9 }, { 100, 11 } }) },
            { 125, new(new() { { 100, 137 } }) },
            { 126, new(new() { { 100, 147 } }) },
            { 127, new(new() { { 50, 2 }, { 65, 3 }, { 80, 4 }, { 95, 9 }, { 100, 10 } }) },
            { 128, new(new() { { 40, 2 }, { 58, 3 }, { 75, 4 }, { 93, 7 }, { 100, 8 } }) },
            { 129, new(new() { { 44, 2 }, { 59, 3 }, { 73, 4 }, { 93, 9 }, { 100, 10 } }) },
            { 130, new(new() { { 60, 2 }, { 70, 7 }, { 80, 5 }, { 90, 9 }, { 100, 15 } }) },
            { 131, new(new() { { 15, 1 }, { 60, 2 }, { 85, 3 }, { 100, 7 } }) },
            { 132, new(new() { { 10, 4 }, { 20, 7 }, { 25, 8 }, { 40, 1 }, { 80, 2 }, { 100, 3 } }) },
            { 133, new(new() { { 45, 15 }, { 50, 9 }, { 55, 7 }, { 60, 4 }, { 85, 3 }, { 95, 2 }, { 100, 1 } }) },
            { 134, new(new() { { 25, 3 }, { 40, 49 }, { 85, 2 }, { 100, 1 } }) },
            { 135, new(new() { { 15, 49 }, { 30, 148 }, { 100, 2 } }) },
            { 136, new(new() { { 15, 149 }, { 85, 2 }, { 100, 49 } }) },
            { 137, new(new() { { 10, 1 }, { 50, 2 }, { 70, 3 }, { 85, 4 }, { 100, 15 } }) },
            { 138, new(new() { { 10, 4 }, { 25, 7 }, { 40, 1 }, { 80, 2 }, { 100, 3 } }) },
            { 139, new(new() { { 100, 151 } }) },
            { 140, new(new() { { 100, 156 } }) },
            { 141, new(new() { { 100, 150 } }) },
            { 142, new(new() { { 5, 15 }, { 25, 2 }, { 65, 1 }, { 80, 3 }, { 90, 4 } }) },
            { 143, new(new() { { 100, 160 } }) },
            { 144, new(new() { { 100, 161 } }) },
            { 145, new(new() { { 100, 157 } }) },
            { 146, new(new() { { 100, 128 } }) },
            { 147, new(new() { { 100, 162 } }) },
            { 148, new(new() { { 25, 1 }, { 70, 2 }, { 80, 3 }, { 90, 7 }, { 95, 4 }, { 100, 8 } }) },
            { 149, new(new() { { 100, 171 } }) },
            { 150, new(new() { { 100, 77 } }) },
            { 151, new(new() {  }) },
            { 152, new(new() {  }) },
            { 153, new(new() {  }) },
            { 154, new(new() {  }) },
            { 155, new(new() {  }) },
            { 156, new(new() {  }) },
            { 157, new(new() {  }) },
            { 158, new(new() {  }) },
            { 159, new(new() {  }) },
            { 160, new(new() {  }) },
        };

        public static WeatherRateList GetWeatherRateList(int rateID)
            => Data.GetValueOrDefault(rateID);

        public static int GetWeather(int rateListID, int rate)
            => GetWeatherRateList(rateListID).GetWeather(rate);

        public static bool HaveWeather(int rateListID, int weatherID)
            => GetWeatherRateList(rateListID).ContainsValue(weatherID);
    }
}
